<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Day 18 - Async JS II Demo</title>
</head>
<body>
  <h1>4. AbortController Demo</h1>
  <button id="load-data">Load Data</button>
  <button id="cancel-request">Cancel Request</button>

  <script>

    let controller,timeoutId;

    async function loadData() {
  controller = new AbortController();
  const signal = controller.signal;

  clearTimeout(timeoutId);
  timeoutId = setTimeout(() => {
    controller.abort();
    console.log('Request aborted due to timeout ⏳');
  }, 5000);

  try {
    const res = await fetch('https://jsonplaceholder.typicode.com/posts/1', { signal });
    const data = await res.json();
    console.log('Data loaded:', data);
  } catch (err) {
    if (err.name === 'AbortError') {
      console.log('Fetch was cancelled!');
    } else {
      console.error('Fetch failed:', err);
    }
  } finally {
    clearTimeout(timeoutId);
  }
}
 function cancelRequest(){
      if (controller){
      controller.abort();
    console.log("Cancel button was clicked from your side.")
    }
    clearTimeout(timeoutId);
  }

    document.getElementById("cancel-request").addEventListener("click",()=>{
      cancelRequest();
    })

    document.getElementById('load-data').addEventListener("click",()=>{
      loadData();
    })
  </script>
</body>
</html>
